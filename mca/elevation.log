2025-04-21 19:15:52,538 - INFO - --- Running elevation.py Standalone Test ---
2025-04-21 19:15:52,538 - INFO - Using Output Directory: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915
2025-04-21 19:15:52,538 - INFO - Configured DEM Interpolation Method: natural_neighbor (default)
2025-04-21 19:15:52,586 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy
2025-04-21 19:15:52,589 - INFO - State start
2025-04-21 19:15:52,594 - INFO -   Scheduler at:     tcp://127.0.0.1:53329
2025-04-21 19:15:52,594 - INFO -   dashboard at:  http://127.0.0.1:8787/status
2025-04-21 19:15:52,594 - INFO - Registering Worker plugin shuffle
2025-04-21 19:15:52,600 - INFO -         Start Nanny at: 'tcp://127.0.0.1:53332'
2025-04-21 19:15:53,476 - INFO -       Start worker at:      tcp://127.0.0.1:53334
2025-04-21 19:15:53,476 - INFO -          Listening to:      tcp://127.0.0.1:53334
2025-04-21 19:15:53,476 - INFO -           Worker name:                          0
2025-04-21 19:15:53,476 - INFO -          dashboard at:            127.0.0.1:53335
2025-04-21 19:15:53,476 - INFO - Waiting to connect to:      tcp://127.0.0.1:53329
2025-04-21 19:15:53,476 - INFO - -------------------------------------------------
2025-04-21 19:15:53,476 - INFO -               Threads:                          1
2025-04-21 19:15:53,476 - INFO -                Memory:                  32.00 GiB
2025-04-21 19:15:53,476 - INFO -       Local Directory: /var/folders/9t/2ktxww317sjf49by2n8qnpb80000gp/T/dask-scratch-space/worker-mkv9zpqz
2025-04-21 19:15:53,476 - INFO - -------------------------------------------------
2025-04-21 19:15:53,511 - INFO - Register worker addr: tcp://127.0.0.1:53334 name: 0
2025-04-21 19:15:53,516 - INFO - Starting worker compute stream, tcp://127.0.0.1:53334
2025-04-21 19:15:53,516 - INFO - Starting established connection to tcp://127.0.0.1:53336
2025-04-21 19:15:53,517 - INFO - Starting Worker plugin shuffle
2025-04-21 19:15:53,517 - INFO -         Registered to:      tcp://127.0.0.1:53329
2025-04-21 19:15:53,518 - INFO - -------------------------------------------------
2025-04-21 19:15:53,518 - INFO - Starting established connection to tcp://127.0.0.1:53329
2025-04-21 19:15:53,542 - INFO - Receive client connection: Client-47d3073a-1ed4-11f0-aca2-92a859213c95
2025-04-21 19:15:53,542 - INFO - Starting established connection to tcp://127.0.0.1:53337
2025-04-21 19:15:53,543 - INFO - Dask client started: http://127.0.0.1:8787/status
2025-04-21 19:15:53,543 - INFO - --- Testing Elevation Feature ---
2025-04-21 19:15:53,543 - INFO - 1. Testing Elevation Load Data...
2025-04-21 19:15:53,543 - INFO - Loading N50 contour data...
2025-04-21 19:15:53,543 - INFO - Loading vector data from: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/data/Basisdata_03_Oslo_25833_N50Kartdata_FGDB.gdb (Layer: N50_HÃ¸yde_senterlinje)
2025-04-21 19:15:53,635 - INFO - Loaded 2268 features with CRS: EPSG:25833
2025-04-21 19:15:53,638 - INFO - Saving 2268 features to: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/prepared_contours.gpkg (Layer: None, Driver: GPKG)
2025-04-21 19:15:53,681 - INFO - Created 2,268 records
2025-04-21 19:15:53,687 - INFO - Save complete.
2025-04-21 19:15:53,687 - INFO - Saved intermediate vector data: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/prepared_contours.gpkg
2025-04-21 19:15:53,687 - INFO - N50 Contours loaded and preprocessed.
2025-04-21 19:15:53,687 - INFO - N50 Contours loaded. Shape: (2268, 9), CRS after load_data: EPSG:25833
2025-04-21 19:15:53,687 - INFO - Using elevation field: 'hoyde'
2025-04-21 19:15:53,687 - INFO - 2. Testing Elevation Build (DEM and Slope)...
2025-04-21 19:15:53,687 - INFO - CRS before build: EPSG:25833
2025-04-21 19:15:53,687 - INFO - Target output CRS from settings: EPSG:25833
2025-04-21 19:15:53,745 - INFO - Building DEM and Slope rasters...
2025-04-21 19:15:53,747 - INFO - Method 'natural_neighbor' requires points. Converting contours...
2025-04-21 19:15:57,857 - INFO - Converted/processed 2268 input features to 141772 points.
2025-04-21 19:15:57,861 - INFO - Saving 141772 features to: /var/folders/9t/2ktxww317sjf49by2n8qnpb80000gp/T/elevation_wbt_ziie044x/contour_points.shp (Layer: None, Driver: ESRI Shapefile)
2025-04-21 19:15:58,458 - INFO - Created 141,772 records
2025-04-21 19:15:58,459 - INFO - Save complete.
2025-04-21 19:15:58,459 - INFO - Saved temporary points shapefile: /var/folders/9t/2ktxww317sjf49by2n8qnpb80000gp/T/elevation_wbt_ziie044x/contour_points.shp
2025-04-21 19:15:58,459 - INFO - Running WBT 'natural_neighbor' interpolation (field: 'hoyde')...
2025-04-21 19:16:13,204 - INFO - Rewriting /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif to temporary file /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.temp_crs.tif with CRS EPSG:25833
2025-04-21 19:16:13,238 - INFO - Successfully rewrote /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif with correct CRS.
2025-04-21 19:16:13,238 - INFO - Generated DEM raster (natural_neighbor): /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif
2025-04-21 19:16:13,238 - INFO - Calculating slope from natural_neighbor DEM...
2025-04-21 19:16:13,371 - INFO - Rewriting /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif to temporary file /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.temp_crs.tif with CRS EPSG:25833
2025-04-21 19:16:13,400 - INFO - Successfully rewrote /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif with correct CRS.
2025-04-21 19:16:13,400 - INFO - Generated Slope raster (natural_neighbor): /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif
2025-04-21 19:16:13,422 - INFO - Elevation build process completed.
2025-04-21 19:16:13,422 - INFO - --- Processing Generated Rasters for Display ---
2025-04-21 19:16:13,423 - INFO - Processing raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif
2025-04-21 19:16:13,444 - INFO -   - Raster CRS read from file: EPSG:25833
2025-04-21 19:16:13,445 - INFO -   - Raster CRS matches target EPSG:25833.
2025-04-21 19:16:13,445 - INFO -   - Preparing to display raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif
2025-04-21 19:16:13,445 - INFO -   - Calling display_raster_on_folium_map with:
2025-04-21 19:16:13,445 - INFO -     - raster_path_str: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif
2025-04-21 19:16:13,445 - INFO -     - output_html_path_str: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem_map.html
2025-04-21 19:16:13,445 - INFO -     - target_crs_epsg: 25833
2025-04-21 19:16:13,878 - INFO - Attempting to display raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem.tif on Folium map.
2025-04-21 19:16:13,880 - INFO - Folium Display: Raster CRS read from file: EPSG:25833
2025-04-21 19:16:13,903 - INFO - Folium Display: Original bounds (EPSG:25833): BoundingBox(left=248710.41839999985, bottom=6637459.371200001, right=273910.41839999985, top=6674524.371200001)
2025-04-21 19:16:13,908 - INFO - Folium Display: Transformed bounds (EPSG:4326): (10.474642729032434, 59.798416630106814, 10.967681509822732, 60.144917389596536)
2025-04-21 19:16:14,666 - INFO - Folium map with raster overlay saved to: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem_map.html
2025-04-21 19:16:14,667 - INFO -   - Saved visualization map: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/elevation_dem_map.html
2025-04-21 19:16:14,667 - INFO - Processing raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif
2025-04-21 19:16:14,669 - INFO -   - Raster CRS read from file: EPSG:25833
2025-04-21 19:16:14,669 - INFO -   - Raster CRS matches target EPSG:25833.
2025-04-21 19:16:14,669 - INFO -   - Preparing to display raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif
2025-04-21 19:16:14,669 - INFO -   - Calling display_raster_on_folium_map with:
2025-04-21 19:16:14,669 - INFO -     - raster_path_str: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif
2025-04-21 19:16:14,669 - INFO -     - output_html_path_str: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope_map.html
2025-04-21 19:16:14,669 - INFO -     - target_crs_epsg: 25833
2025-04-21 19:16:14,669 - INFO - Attempting to display raster: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope.tif on Folium map.
2025-04-21 19:16:14,671 - INFO - Folium Display: Raster CRS read from file: EPSG:25833
2025-04-21 19:16:14,689 - INFO - Folium Display: Original bounds (EPSG:25833): BoundingBox(left=248710.41839999985, bottom=6637459.371200001, right=273910.41839999985, top=6674524.371200001)
2025-04-21 19:16:14,690 - INFO - Folium Display: Transformed bounds (EPSG:4326): (10.474642729032434, 59.798416630106814, 10.967681509822732, 60.144917389596536)
2025-04-21 19:16:15,967 - INFO - Folium map with raster overlay saved to: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope_map.html
2025-04-21 19:16:15,967 - INFO -   - Saved visualization map: /Users/per.morten.halvorsen@schibsted.com/uio/geo4460/mca/output/mca_20250421_1915/slope_map.html
2025-04-21 19:16:15,967 - INFO - --- Elevation Feature Test Completed ---
2025-04-21 19:16:15,968 - INFO - Remove client Client-47d3073a-1ed4-11f0-aca2-92a859213c95
2025-04-21 19:16:15,968 - INFO - Received 'close-stream' from tcp://127.0.0.1:53337; closing.
2025-04-21 19:16:15,969 - INFO - Remove client Client-47d3073a-1ed4-11f0-aca2-92a859213c95
2025-04-21 19:16:15,969 - INFO - Close client connection: Client-47d3073a-1ed4-11f0-aca2-92a859213c95
2025-04-21 19:16:15,969 - INFO - Dask client closed.
2025-04-21 19:16:15,970 - INFO - Retire worker addresses (stimulus_id='retire-workers-1745255775.970059') (0,)
2025-04-21 19:16:15,970 - INFO - Closing Nanny at 'tcp://127.0.0.1:53332'. Reason: nanny-close
2025-04-21 19:16:15,970 - INFO - Nanny asking worker to close. Reason: nanny-close
2025-04-21 19:16:15,970 - INFO - Stopping worker at tcp://127.0.0.1:53334. Reason: nanny-close
2025-04-21 19:16:15,971 - INFO - Removing Worker plugin shuffle
2025-04-21 19:16:15,972 - INFO - Received 'close-stream' from tcp://127.0.0.1:53336; closing.
2025-04-21 19:16:15,972 - INFO - Remove worker addr: tcp://127.0.0.1:53334 name: 0 (stimulus_id='handle-worker-cleanup-1745255775.972252')
2025-04-21 19:16:15,972 - INFO - Lost all workers
2025-04-21 19:16:15,972 - INFO - Connection to tcp://127.0.0.1:53329 has been closed.
2025-04-21 19:16:16,107 - INFO - Nanny at 'tcp://127.0.0.1:53332' closed.
2025-04-21 19:16:16,107 - INFO - Closing scheduler. Reason: unknown
2025-04-21 19:16:16,108 - INFO - Scheduler closing all comms
2025-04-21 19:16:16,109 - INFO - Dask cluster closed.
2025-04-21 19:16:16,109 - INFO - --- Standalone Test Finished ---
