<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
        <head>
            <meta content=\"text/html; charset=UTF-8\" http-equiv=\"content-type\">
            <title>Profile</title><style type="text/css">
            h1 {
                font-size: 14pt;
                margin-left: 15px;
                margin-right: 15px;
                text-align: center;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
            }
            h2 {
                font-size: 12pt;
                margin-left: 15px;
                margin-right: 15px;
                text-align: center;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
            }
            p, ol, ul {
                font-size: 12pt;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                margin-left: 15px;
                margin-right: 15px;
            }
            caption {
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                font-size: 12pt;
                margin-left: 15px;
                margin-right: 15px;
            }
            table {
                font-size: 12pt;
                font-family: Helvetica, Verdana, Geneva, Arial, sans-serif;
                font-family: arial, sans-serif;
                border-collapse: collapse;
                align: center;
            }
            td, th {
                border: 1px solid #222222;
                text-align: centre;
                padding: 8px;
            }
            tr:nth-child(even) {
                background-color: #dddddd;
            }
            tr:hover {
                background-color: lightyellow;
            }
            .bareTd {
                border: 0px solid #222222;
                text-align: centre;
                padding: 8px;
            }
            .bareTr:nth-child(even) {
                background-color: white;
            }
            .bareTr:hover {
                background-color: white;
            }
            .numberCell {
                text-align: right;
            }
            .header {
                font-weight: bold;
                text-align: center;
            }
        </style></head>
        <body>
            <h1>Profile</h1><p><strong>Input Surface</strong>: TopoRaster_all<br></p><div id='graph' align="center">
    <script>
      var plot = {
        dataX: [[50.005914550510646, 100.01182910102129, 150.01774365153193, 200.02365820204258, 250.02957275255324, 300.03548730306386, 350.0414018535745, 400.0473164040851, 450.05323095459573, 500.05914550510636, 550.065060055617, 600.0709746061276, 650.0768891566382, 700.0828037071489, 750.0887182576595, 800.0946328081701, 850.1005473586807, 900.1064619091914, 950.112376459702, 1000.1182910102126, 1050.1242055607233, 1100.130120111234, 1150.1360346617446, 1200.1419492122552, 1250.1478637627658, 1300.1537783132765, 1350.159692863787, 1400.1656074142977, 1450.1715219648083, 1500.177436515319, 1550.1833510658296, 1600.1892656163402, 1650.1951801668508, 1700.2010947173615, 1750.207009267872, 1800.2129238183827, 1850.2188383688933, 1900.224752919404, 1950.2306674699146, 2000.2365820204252, 2050.242496570936, 2100.2484111214467, 2150.2543256719573, 2200.260240222468, 2250.2661547729786, 2300.272069323489, 2350.277983874, 2400.2838984245104, 2450.289812975021, 2500.2957275255317, 2550.3016420760423, 2600.307556626553, 2650.3134711770635, 2700.319385727574, 2750.325300278085, 2800.3312148285954, 2850.337129379106, 2900.3430439296167, 2950.3489584801273, 3000.354873030638, 3050.3607875811485, 3100.366702131659, 3150.37261668217, 3200.3785312326804, 3250.384445783191, 3300.3903603337017, 3350.3962748842123, 3400.402189434723, 3450.4081039852335, 3500.414018535744, 3550.419933086255, 3600.4258476367654, 3650.431762187276, 3700.4376767377867, 3750.4435912882973, 3800.449505838808, 3850.4554203893185, 3900.461334939829, 3950.46724949034, 4000.4731640408504, 4050.479078591361, 4100.484993141872, 4150.490907692383, 4200.496822242894, 4250.502736793405, 4300.508651343916, 4350.5145658944275, 4400.520480444939, 4450.52639499545, 4500.532309545961, 4550.538224096472, 4600.544138646983, 4650.550053197494, 4700.555967748005, 4750.561882298516, 4800.567796849027, 4850.573711399538, 4900.579625950049, 4950.5855405005605, 5000.5914550510715, 5050.597369601583, 5100.603284152094, 5150.609198702605, 5200.615113253116, 5250.621027803627, 5300.626942354138, 5350.632856904649, 5400.63877145516, 5450.644686005671, 5500.650600556182, 5550.656515106693, 5600.6624296572045, 5650.668344207716, 5700.674258758227, 5750.680173308738, 5800.686087859249, 5850.69200240976, 5900.697916960271, 5950.703831510782, 6000.709746061293, 6050.715660611804, 6100.721575162315, 6150.727489712826, 6200.733404263337, 6250.7393188138485, 6300.74523336436, 6350.751147914871, 6400.757062465382, 6450.762977015893, 6500.768891566404, 6550.774806116915, 6600.780720667426, 6650.786635217937, 6700.792549768448, 6750.798464318959, 6800.80437886947, 6850.8102934199815, 6900.8162079704925, 6950.822122521004, 7000.828037071515, 7050.833951622026, 7100.839866172537, 7150.845780723048, 7200.851695273559, 7250.85760982407, 7300.863524374581, 7350.869438925092, 7400.875353475603, 7450.881268026114, 7500.8871825766255, 7550.893097127137, 7600.899011677648, 7650.904926228159, 7700.91084077867, 7750.916755329181, 7800.922669879692, 7850.928584430203, 7900.934498980714, 7950.940413531225, 8000.946328081736, 8050.952242632247, 8100.958157182758, 8150.9640717332695, 8200.96998628378, 8250.975900834292, 8300.981815384803, 8350.987729935314, 8400.993644485825, 8450.999559036336, 8501.005473586847, 8551.011388137358, 8601.01730268787, 8651.02321723838, 8701.029131788891, 8751.035046339402, 8801.040960889914, 8851.046875440425, 8901.052789990936, 8951.058704541447, 9001.064619091958, 9051.070533642469, 9101.07644819298, 9151.082362743491, 9201.088277294002, 9251.094191844513, 9301.100106395024, 9351.106020945535, 9401.111935496046, 9451.117850046558, 9501.123764597069, 9551.12967914758, 9601.13559369809, 9651.141508248602, 9701.147422799113, 9751.153337349624, 9801.159251900135, 9851.165166450646, 9901.171081001157, 9951.176995551668, 10001.18291010218, 10051.18882465269, 10101.194739203202, 10151.200653753713, 10201.206568304224, 10251.212482854735, 10301.218397405246, 10351.224311955757, 10401.230226506268, 10451.23614105678, 10501.24205560729, 10551.247970157801, 10601.253884708312, 10651.259799258823, 10701.265713809335, 10751.271628359846, 10801.277542910357, 10851.283457460868, 10901.289372011379, 10951.29528656189, 11001.301201112401, 11051.307115662912, 11101.313030213423, 11151.318944763934, 11201.324859314445, 11251.330773864956, 11301.336688415468, 11351.342602965979, 11401.34851751649, 11451.354432067, 11501.360346617512, 11551.366261168023, 11601.372175718534, 11651.378090269045, 11701.384004819556, 11751.389919370067, 11801.395833920578, 11851.40174847109, 11901.4076630216, 11951.413577572112, 12001.419492122623, 12051.425406673134, 12101.431321223645, 12151.437235774156, 12201.443150324667, 12251.449064875178, 12301.454979425689, 12351.4608939762, 12401.466808526711, 12451.472723077222, 12501.478637627733, 12551.484552178244, 12601.490466728756, 12651.496381279267, 12701.502295829778, 12751.508210380289, 12801.5141249308, 12851.520039481311, 12901.525954031822, 12951.531868582333, 13001.537783132844, 13051.543697683355, 13101.549612233866, 13151.555526784377, 13201.561441334889, 13251.5673558854, 13301.57327043591, 13351.579184986422, 13401.585099536933, 13451.591014087444, 13501.596928637955, 13551.602843188466, 13601.608757738977, 13651.614672289488, 13701.62058684, 13751.62650139051, 13801.632415941021, 13851.638330491533, 13901.644245042044, 13951.650159592555, 14001.656074143066, 14051.661988693577, 14101.667903244088, 14151.673817794599, 14201.67973234511, 14251.685646895621, 14301.691561446132, 14351.697475996643, 14401.703390547154, 14451.709305097665, 14501.715219648177, 14551.721134198688, 14601.727048749199, 14651.73296329971, 14701.73887785022, 14751.744792400732, 14801.750706951243, 14851.756621501754, 14901.762536052265, 14951.768450602776, 15001.774365153287, 15051.780279703798, 15101.78619425431, 15151.79210880482, 15201.798023355332, 15251.803937905843, 15301.809852456354, 15351.815767006865, 15401.821681557376, 15451.827596107887, 15501.833510658398, 15551.83942520891, 15601.84533975942, 15651.851254309931, 15701.857168860442, 15751.863083410954, 15801.868997961465, 15851.874912511976, 15901.880827062487, 15951.886741612998, 16001.892656163509, 16051.89857071402, 16101.904485264531, 16151.910399815042, 16201.916314365553, 16251.922228916064, 16301.928143466575, 16351.934058017086, 16401.939972567598, 16451.94588711811, 16501.95180166862, 16551.95771621913, 16601.963630769642, 16651.969545320153, 16701.975459870664, 16751.981374421175, 16801.987288971686, 16851.993203522197, 16901.99911807271, 16952.00503262322, 17002.01094717373, 17052.01686172424, 17102.022776274753, 17152.028690825264, 17202.034605375775, 17252.040519926286, 17302.046434476797, 17352.052349027308, 17402.05826357782, 17452.06417812833, 17502.07009267884, 17552.076007229352, 17602.081921779863, 17652.087836330375]],
        dataY: [[1559.80908203125, 1577.342041015625, 1571.8802490234375, 1568.003662109375, 1548.148681640625, 1534.9150390625, 1534.9150390625, 1519.1641845703125, 1500.138671875, 1488.9892578125, 1477.7989501953125, 1471.35986328125, 1463.7742919921875, 1478.896240234375, 1478.537353515625, 1499.091064453125, 1520.0791015625, 1519.6903076171875, 1534.6397705078125, 1534.6397705078125, 1544.04296875, 1541.042724609375, 1558.4029541015625, 1554.048583984375, 1567.4305419921875, 1559.5872802734375, 1579.1097412109375, 1566.4024658203125, 1564.1510009765625, 1543.9434814453125, 1530.064453125, 1515.3072509765625, 1515.3072509765625, 1498.9111328125, 1481.4759521484375, 1468.753173828125, 1457.9564208984375, 1446.9705810546875, 1446.9459228515625, 1446.9459228515625, 1446.9459228515625, 1446.9459228515625, 1446.9459228515625, 1457.4591064453125, 1468.300537109375, 1471.565673828125, 1493.4915771484375, 1513.38330078125, 1544.4244384765625, 1573.377685546875, 1616.008056640625, 1651.6619873046875, 1662.0009765625, 1698.8134765625, 1746.201416015625, 1785.9608154296875, 1835.6036376953125, 1876.86767578125, 1884.834228515625, 1922.507568359375, 1963.542236328125, 1993.3929443359375, 1975.8187255859375, 1947.763916015625, 1913.435546875, 1918.2889404296875, 1889.8223876953125, 1876.9276123046875, 1853.37646484375, 1830.6448974609375, 1795.8250732421875, 1788.42822265625, 1752.240234375, 1706.7694091796875, 1676.552978515625, 1642.747802734375, 1621.134765625, 1602.523681640625, 1601.1636962890625, 1588.904296875, 1577.1866455078125, 1566.627685546875, 1554.5731201171875, 1546.7984619140625, 1544.653076171875, 1539.0714111328125, 1529.985107421875, 1524.7255859375, 1520.5928955078125, 1528.8037109375, 1538.989501953125, 1538.989501953125, 1549.6473388671875, 1562.56884765625, 1579.053955078125, 1598.593994140625, 1618.9678955078125, 1621.0845947265625, 1646.0615234375, 1681.5159912109375, 1717.593017578125, 1761.4600830078125, 1800.9110107421875, 1852.52783203125, 1852.52783203125, 1911.009521484375, 1952.6446533203125, 1996.2681884765625, 2003.590576171875, 1976.844482421875, 1968.8037109375, 1928.25, 1872.625, 1843.7901611328125, 1810.0360107421875, 1801.824951171875, 1790.19384765625, 1790.19384765625, 1787.3582763671875, 1793.334716796875, 1797.3046875, 1809.22705078125, 1816.4345703125, 1809.166015625, 1823.929443359375, 1832.177734375, 1841.7913818359375, 1840.2518310546875, 1842.0865478515625, 1838.3946533203125, 1838.3946533203125, 1829.076416015625, 1828.393310546875, 1826.6494140625, 1839.8065185546875, 1855.4451904296875, 1855.4451904296875, 1874.1854248046875, 1905.475830078125, 1924.4739990234375, 1942.5975341796875, 1978.289794921875, 1994.8795166015625, 1994.8795166015625, 2011.44482421875, 2046.1802978515625, 2062.351318359375, 2091.595458984375, 2095.095458984375, 2095.095458984375, 2090.29931640625, 2099.06396484375, 2091.839599609375, 2102.832275390625, 2101.277587890625, 2100.244140625, 2100.244140625, 2099.57568359375, 2114.45361328125, 2117.033203125, 2133.790283203125, 2139.71044921875, 2139.71044921875, 2145.4560546875, 2160.160888671875, 2159.945556640625, 2151.246337890625, 2129.24755859375, 2089.4072265625, 2099.759765625, 2063.63134765625, 2011.6041259765625, 1971.633544921875, 1919.79833984375, 1883.78271484375, 1883.78271484375, 1850.891845703125, 1805.4169921875, 1775.2669677734375, 1730.388916015625, 1696.51513671875, 1648.982177734375, 1657.463134765625, 1610.216552734375, 1573.0277099609375, 1538.5848388671875, 1501.9342041015625, 1467.9224853515625, 1433.703369140625, 1433.85498046875, 1403.7799072265625, 1379.3135986328125, 1358.722412109375, 1340.6947021484375, 1326.6209716796875, 1324.913818359375, 1314.7537841796875, 1300.504150390625, 1301.7010498046875, 1297.8642578125, 1305.281494140625, 1308.1790771484375, 1297.034912109375, 1308.667724609375, 1311.6004638671875, 1318.952880859375, 1319.45263671875, 1335.7191162109375, 1326.2310791015625, 1344.307373046875, 1350.9888916015625, 1366.458740234375, 1363.2763671875, 1378.2486572265625, 1369.2872314453125, 1369.2872314453125, 1360.9747314453125, 1353.498779296875, 1363.458740234375, 1356.1434326171875, 1366.59375, 1349.664306640625, 1358.9288330078125, 1351.707763671875, 1361.2344970703125, 1361.3790283203125, 1370.8963623046875, 1361.866943359375, 1361.866943359375, 1361.2657470703125, 1371.936767578125, 1365.5771484375, 1366.0330810546875, 1381.12646484375, 1374.0633544921875, 1389.0482177734375, 1391.7410888671875, 1397.7001953125, 1390.9659423828125, 1400.80224609375, 1394.9981689453125, 1394.9981689453125, 1396.984619140625, 1412.6976318359375, 1410.6123046875, 1422.4549560546875, 1403.243408203125, 1368.3001708984375, 1377.65234375, 1353.2191162109375, 1364.0755615234375, 1349.3726806640625, 1362.8671875, 1354.0828857421875, 1354.0828857421875, 1342.5755615234375, 1364.26171875, 1356.24169921875, 1381.5093994140625, 1376.933837890625, 1376.933837890625, 1369.635498046875, 1391.033935546875, 1370.825439453125, 1344.3714599609375, 1355.1781005859375, 1324.7430419921875, 1324.7430419921875, 1298.2508544921875, 1312.921630859375, 1292.2144775390625, 1308.369140625, 1283.74365234375, 1283.74365234375, 1256.419921875, 1263.069091796875, 1235.6820068359375, 1240.0169677734375, 1221.5791015625, 1202.322509765625, 1202.322509765625, 1189.30517578125, 1195.0523681640625, 1182.54296875, 1185.07958984375, 1175.584716796875, 1175.584716796875, 1162.0299072265625, 1160.2259521484375, 1143.32421875, 1140.5087890625, 1121.971435546875, 1120.62939453125, 1103.0179443359375, 1084.319091796875, 1080.168701171875, 1058.5576171875, 1064.7379150390625, 1056.329345703125, 1056.329345703125, 1042.138916015625, 1041.2174072265625, 1028.251708984375, 1028.1728515625, 1017.7978515625, 1020.3512573242188, 1012.3939208984375, 1011.3162231445313, 999.3209838867188, 987.890380859375, 986.095703125, 978.7929077148438, 978.7929077148438, 968.9747924804688, 966.1547241210938, 958.9164428710938, 959.5899658203125, 956.0062866210938, 954.7164916992188, 962.7994384765625, 962.0009765625, 958.8267822265625, 952.505126953125, 956.5997314453125, 948.779541015625, 956.0791015625, 953.87158203125, 945.5580444335938, 945.3621826171875, 942.4398803710938, 941.6802978515625, 940.0338134765625, 943.7272338867188, 939.9364013671875, 939.9453735351563, 937.6318359375, 939.8946533203125, 939.5555419921875, 943.1417236328125, 940.2513427734375, 940.885986328125, 940.8818359375, 935.146728515625, 932.040771484375, 926.246337890625, 928.421875, 923.6732177734375, 923.028564453125, 920.42578125, 924.2589111328125, 919.48828125, 930.0478515625, 924.8281860351563]],
        seriesLabels: ["Profile 1"],
        xAxisLabel: "Distance",
        yAxisLabel: "Elevation",
        width: 700,
        height: 500,
        drawPoints: false,
        drawGridlines: true,
        drawLegend: false,
        drawGreyBackground: false,
        parentId: "graph"
      };
      function update(svg) {
        // which of the series labels is longest?
        var maxSeriesLabelLength = 0;
        var a;
        for (a = 0; a < plot.seriesLabels.length; a++) {
          var sl = plot.seriesLabels[a];
          if (sl.length > maxSeriesLabelLength) { maxSeriesLabelLength = sl.length; }
        }
        var plotLeftMargin = 70.0;
        var plotRightMargin = plot.drawLegend ? 65.0 + maxSeriesLabelLength * 7 : 50.0;
        var plotBottomMargin = 70.0;
        var plotTopMargin = 40.0;
        var plotWidth = plot.width - plotLeftMargin - plotRightMargin;
        var plotHeight = plot.height - plotBottomMargin - plotTopMargin;
        var originX = plotLeftMargin;
        var originY = plotTopMargin + plotHeight;
        var tickLen = 8.0;
        var minorTickLen = tickLen * 0.65;

        // If there are no series labels, treat it as one series.
        if (plot.seriesLabels.length === 0) {
					plot.drawLegend = false;
				}

        // colors
        var lineColor = '#47a3ff'; //'#377eb8'; // '#729ece'; // '#1f77b4'; //'#47a3ff'; //'rgb(2,145,205)';
        var highlightColor = '#ff7f00';
        var btnColor = 'rgb(170,170,170)';
        var btnHoverColor = 'rgb(150,150,150)';
        var plotBackgroundColor = 'rgb(255,255,255)';
        if (plot.drawGreyBackground) {
          plotBackgroundColor = '#CCC';
        }
        var chartBackgroundColor = 'white';
        // var gridLineColor = 'rgb(120,120,120)';
        // if (plot.drawGreyBackground) {
          var gridLineColor = '#EEE';
        // }
        var trendlineColor = 'DimGray';
        if (plot.drawGreyBackground) {
          trendlineColor = 'DimGray';
        }
        var showValueClr = "black";
        // if (plot.drawGreyBackground) {
        //   showValueClr = '#FFF';
        // }

        // Gridlines
        // var gridlineDash = '1, 5';
        // if (plot.drawGreyBackground) {
          var gridlineDash = 'none';
        // }

        var tableau20 = [[31, 119, 180], [255, 127, 14],
             [44, 160, 44], [214, 39, 40],
             [148, 103, 189], [140, 86, 75],
             [227, 119, 194], [127, 127, 127],
             [188, 189, 34], [23, 190, 207]];

        var regularOpacity = 1.0;
        var deselectedOpacity = 0.10;


        // create the svg element
        var svgns = "http://www.w3.org/2000/svg";
        if (svg == null) {
          svg = document.createElementNS(svgns, "svg");
        } else {
          while (svg.lastChild) {
              svg.removeChild(svg.lastChild);
          }
        }
        svg.setAttribute('width', `${plot.width}`);
        svg.setAttribute('height', `${plot.height}`);
        var div = document.getElementById(plot.parentId);
        if (div != null) {
          div.appendChild(svg);
        } else {
          // add it to the body of the document
          document.querySelector("body").appendChild(svg);
        }

        // how many series are there?
        var numSeries = plot.dataY.length;

        // if dataX is empty, fill it with the series 1, 2, 3, 4, ...
        if (plot.dataX.length == 0) {
          for (s = 0; s < numSeries; s++) {
            var seriesXData = [];
            for (a = 0; a < plot.dataY[s].length; a++) {
              seriesXData.push(a + 1);
            }
            plot.dataX.push(seriesXData);
          }
        }

        // style
        var style = document.createElement("style");
        let styleString = `
        text {
          font-family:Sans,Arial;
        }
        .axisLabel {
          font-weight: normal;
        }
        .xTickLabel {
          fill: black;
          font-size: 85%;
          font-weight: lighter;
        }
        .yTickLabel {
          fill: black;
          font-size: 85%;
          font-weight: lighter;
        }
        .gridLine {
          stroke: ${gridLineColor};
          stroke-dasharray: ${gridlineDash};
          stroke-width: 0.8;
        }
        .tick {
          stroke: black;
          stroke-width: 0.5;
        }
        #plotBorder {
          fill: none;
          stroke: black;
          stroke-width: 0.5;
        }
        #showValue {
          font-size: 85%;
          fill: ${showValueClr};
        }
        #context-menu {
          position:absolute;
          display:none;
        }
        #context-menu ul {
          list-style:none;
          margin:0;
          padding:0;
          background: #EFEFEF;
          opacity: 0.90;
        }
        #context-menu {
          border:solid 1px #CCC;
        }
        #context-menu li {
          font-family:Sans,Arial;
          font-size: 75%;
          text-align: left;
          color:#000;
          display:block;
          padding:5px 15px;
          border-bottom:solid 1px #CCC;
        }
        #context-menu li:last-child {
          border:none;
        }
        #context-menu li:hover {
          background:#007AFF;
          color:#FFF;
        }
        `;

        var dataPointHoverWidth = 4.0;
        if (!plot.drawPoints) {
          dataPointHoverWidth = 6.0;
        }
        var s;
        for (s = 0; s < numSeries; s++) {
          var clrNum = s % tableau20.length;
          if (plot.seriesLabels.length === 0) {
            // If there are no series labels, treat it as one series.
						clrNum = 0;
					}
          let clr = `rgb(${tableau20[clrNum][0]},${tableau20[clrNum][1]},${tableau20[clrNum][2]})`;

          styleString += `
          .seriesLine${s} {
            fill: none;
            stroke-width:1;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLine${s}:hover {
            fill: none;
            stroke-width:2;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLineThick${s} {
            fill: none;
            stroke-width:2;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .seriesLineThick${s}:hover {
            fill: none;
            stroke-width:3;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .dataPoint${s} {
            fill: ${clr};
            stroke-width:0;
            stroke: ${clr};
            opacity: ${regularOpacity};
          }
          .dataPoint${s}:hover {
            fill: red;
            stroke-width:${dataPointHoverWidth};
            stroke: red;
            opacity:1.0;
          }
          `;
        }
        style.innerHTML = styleString;
        svg.appendChild(style);
        svg.id = "plotSvg";

        // background
        var background = document.createElementNS(svgns, "rect");
        background.setAttribute('width', plot.width);
        background.setAttribute('height', plot.height);
        background.style.fill = chartBackgroundColor;
        svg.appendChild(background);

        // translate the origin point
        var g = document.createElementNS(svgns, "g");
        g.setAttribute('id', 'transform');
        g.setAttribute('transform', `translate(${originX},${originY})`);
        svg.appendChild(g);

        // plot background
        var plotBackground = document.createElementNS(svgns, "rect");
        plotBackground.setAttribute('id', 'plotBackground');
        plotBackground.setAttribute('x', 0.0);
        plotBackground.setAttribute('y', -plotHeight);
        plotBackground.setAttribute('width', plotWidth);
        plotBackground.setAttribute('height', plotHeight);
        plotBackground.style.fill = plotBackgroundColor;
        plotBackground.style.stroke = "none";
        g.appendChild(plotBackground);

        // what are the min/max values?
        var xMin = Infinity;
        var xMax = -Infinity;
        var yMin = Infinity;
        var yMax = -Infinity;
        var val = 0;
        var maxNumPoints = 0;
        var totalNumPoints = 0;
        for (s = 0; s < numSeries; s++) {
          var numPoints = Math.min(plot.dataX[s].length, plot.dataY[s].length);
          if (numPoints > maxNumPoints) { maxNumPoints = maxNumPoints; }
          totalNumPoints += numPoints;
          if (numPoints < 2) {
            alert("Too few points for line graph");
            return;
          }
          if (plot.dataX[s].length != plot.dataY[s].length) {
            alert("The x and y data arrays are unequal in length.");
          }
          for (a = 0; a < numPoints; a++) {
              val = plot.dataX[s][a];
              if (val < xMin) { xMin = val; }
              if (val > xMax) { xMax = val; }
              val = plot.dataY[s][a];
              if (val < yMin) { yMin = val; }
              if (val > yMax) { yMax = val; }
          }
        }

        // We don't want a data point to fall on the plot border
        xMin -= 0.0000001;
        yMin -= 0.0000001;
        xMax += 0.0000001;
        yMax += 0.0000001;

        // X axis
        var xAxisTickSpacing = 0.0000001;
        var xAxisNumTicks = 1000;
        var xRange = xMax - xMin;
        a = 0;
        while (xAxisNumTicks > 20) {
          if (a % 2 == 0) {
            xAxisTickSpacing *= 5.0;
          } else {
            xAxisTickSpacing *= 2.0;
          }
          a++;
          xAxisNumTicks = Math.ceil(xRange / xAxisTickSpacing);
        }
        xMin = Math.floor(xMin / xAxisTickSpacing) * xAxisTickSpacing;
        xAxisNumTicks = Math.ceil((xMax - xMin) / xAxisTickSpacing);
        xRange = xAxisTickSpacing * xAxisNumTicks;
        var xSigDigits = Math.max(decimalPlaces(xMin+xAxisTickSpacing), decimalPlaces(xMin+2*xAxisTickSpacing)); //Math.round(0.1 / xAxisTickSpacing);
        if (xSigDigits === 0 && (xMax - xMin) < xAxisNumTicks) { xSigDigits += 1; }
        var dominantTick = 0;
        if (decimalPlaces(xMin) > decimalPlaces(xMin+xAxisTickSpacing)) {
          dominantTick = 1;
        }
        for (a = 0; a <= xAxisNumTicks; a++) {
            // grid line
            if (plot.drawGridlines) {
              if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
                if (a > 0 && a < xAxisNumTicks) {
                  var line = document.createElementNS(svgns, "line");
                  line.setAttribute('x1', (a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y1', 0);
                  line.setAttribute('x2', (a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y2', -plotHeight);
                  line.setAttribute('class', 'gridLine');
                  g.appendChild(line);
                }
              }
            }
            // tick mark
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', (a * xAxisTickSpacing) / xRange * plotWidth);
            line.setAttribute('y1', 0);
            line.setAttribute('x2', (a * xAxisTickSpacing) / xRange * plotWidth);
            if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
              line.setAttribute('y2', tickLen);
            } else {
              line.setAttribute('y2', minorTickLen);
            }
            line.setAttribute('class', 'tick');
            g.appendChild(line);

            // labels
            if (xAxisNumTicks <= 10 || a % 2 == dominantTick) {
                // tick label
                var label = document.createElementNS(svgns, "text");
                label.setAttribute('x', (a * xAxisTickSpacing) / xRange * plotWidth);
                label.setAttribute('y', tickLen + 5);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('dominant-baseline', 'hanging');
                label.setAttribute('class', 'xTickLabel');
                label.innerHTML = `${(xMin + a * xAxisTickSpacing).toFixed(xSigDigits)}`;
                g.appendChild(label);
            }
        }

        // Y axis
        var yAxisTickSpacing = 0.0000001;
        var yAxisNumTicks = 1000;
        var yRange = yMax - yMin;
        a = 0;
        while (yAxisNumTicks > 20) {
          if (a % 2 == 0) {
            yAxisTickSpacing *= 5.0;
          } else {
            yAxisTickSpacing *= 2.0;
          }
          a++;
          yAxisNumTicks = Math.ceil(yRange / yAxisTickSpacing);
        }
        yMin = Math.floor(yMin / yAxisTickSpacing) * yAxisTickSpacing;
        yAxisNumTicks = Math.ceil((yMax - yMin) / yAxisTickSpacing);
        yRange = yAxisTickSpacing * yAxisNumTicks;
        var ySigDigits = Math.max(decimalPlaces(yMin+yAxisTickSpacing), decimalPlaces(yMin+2*yAxisTickSpacing));
        if (ySigDigits === 0 && (yMax - yMin) < yAxisNumTicks) { ySigDigits += 1; }
        dominantTick = 0;
        if (decimalPlaces(yMin) > decimalPlaces(yMin+yAxisTickSpacing)) {
          dominantTick = 1;
        }
        for (a = 0; a <= yAxisNumTicks; a++) {
            // grid line
            if (plot.drawGridlines) {
              if (yAxisNumTicks <= 10 || a % 2 == dominantTick) {
                if (a > 0 && a < yAxisNumTicks) {
                  var line = document.createElementNS(svgns, "line");
                  line.setAttribute('x1', 0); //(a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y1', -(a * yAxisTickSpacing) / yRange * plotHeight);
                  line.setAttribute('x2', plotWidth); //(a * xAxisTickSpacing) / xRange * plotWidth);
                  line.setAttribute('y2', -(a * yAxisTickSpacing) / yRange * plotHeight); //-plotHeight);
                  line.setAttribute('class', 'gridLine');
                  g.appendChild(line);
                }
              }
            }
            // tick mark
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', 0);
            line.setAttribute('y1', -(a * yAxisTickSpacing) / yRange * plotHeight);
            if (yAxisNumTicks <= 6 || a % 2 == dominantTick) {
              line.setAttribute('x2', -tickLen);
            } else {
              line.setAttribute('x2', -minorTickLen);
            }
            line.setAttribute('y2', -(a * yAxisTickSpacing) / yRange * plotHeight);
            line.setAttribute('class', 'tick');
            g.appendChild(line);

            // labels
            if (yAxisNumTicks <= 6 || a % 2 == dominantTick) {
                // s += `<text transform="translate(${-tickLen - 5}, ${-(a * yAxisTickSpacing) / maxVal * plotHeight}), rotate(270)" x="0" y="0" text-anchor="middle" dominant-baseline="no-change" class="yTickLabel">${(a * yAxisTickSpacing).toFixed(ySigDigits)}</text>`;
                var label = document.createElementNS(svgns, "text");
                label.setAttribute('transform', `translate(${-tickLen - 5},${-(a * yAxisTickSpacing) / yRange * plotHeight}), rotate(270)`);
                label.setAttribute('x', 0);
                label.setAttribute('y', 0);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('dominant-baseline', 'no-change');
                label.setAttribute('class', 'yTickLabel');
                label.innerHTML = `${(yMin + a * yAxisTickSpacing).toFixed(ySigDigits)}`;
                g.appendChild(label);
            }
        }

        // axis labels
        var xLabel = document.createElementNS(svgns, "text");
        xLabel.setAttribute('x', plotWidth / 2.0);
        xLabel.setAttribute('y', tickLen + 25.0);
        xLabel.setAttribute('text-anchor', 'middle');
        xLabel.setAttribute('dominant-baseline', 'hanging');
        xLabel.setAttribute('class', 'axisLabel');
        xLabel.innerHTML = plot.xAxisLabel;
        g.appendChild(xLabel);

        var yLabel = document.createElementNS(svgns, "text");
        yLabel.setAttribute('transform', `translate(${-tickLen - 28.0},${-plotHeight / 2.0}), rotate(270)`);
        yLabel.setAttribute('x', 0);
        yLabel.setAttribute('y', 0);
        yLabel.setAttribute('text-anchor', 'middle');
        yLabel.setAttribute('class', 'axisLabel');
        yLabel.innerHTML = plot.yAxisLabel;
        g.appendChild(yLabel);

        // text to show values when hover over
        var showValue = document.createElementNS(svgns, "text");
        showValue.setAttribute('x', 10);
        showValue.setAttribute('text-anchor', 'start');

        // draw the line(s)
        var g2 = document.createElementNS(svgns, "g");
        g2.setAttribute('id', 'lines');
        g.appendChild(g2);

        var radius = 3.0;
        if (totalNumPoints > 15) { radius = 2.5; }
        if (!plot.drawPoints) {
          radius = 1.0;
        }
        for (let s = 0; s < numSeries; s++) {
          var numPoints = Math.min(plot.dataX[s].length, plot.dataY[s].length);
          let seriesLine = document.createElementNS(svgns, "polyline");
          var pointsString = `${(plot.dataX[s][0] - xMin) / xRange * plotWidth},${-(plot.dataY[s][0] - yMin) / yRange * plotHeight}`;
          for (let a = 1; a < numPoints; a++) {
            pointsString += ` ${(plot.dataX[s][a] - xMin) / xRange * plotWidth},${-(plot.dataY[s][a] - yMin) / yRange * plotHeight}`
          }
          seriesLine.setAttribute('points', pointsString);
          var seriesLabel = "seriesLine";
          if (!plot.drawPoints) { seriesLabel = "seriesLineThick"; }
          seriesLine.setAttribute('class', `${seriesLabel}${s}`);
          seriesLine.addEventListener('mouseover', function() {
            var s2;
            for (s2 = 0; s2 < numSeries; s2++) {
              if (s2 != s) {
                var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                var i;
                for (i = 0; i < x.length; i++) {
                  x[i].style.opacity = deselectedOpacity;
                }
                x = document.getElementsByClassName(`dataPoint${s2}`);
                for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = deselectedOpacity;
                }
              }
            }
          }, false);
          seriesLine.addEventListener('mouseout', function() {
            var s2;
            for (s2 = 0; s2 < numSeries; s2++) {
              if (s2 != s) {
                var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                var i;
                for (i = 0; i < x.length; i++) {
                  x[i].style.opacity = regularOpacity;
                }
                x = document.getElementsByClassName(`dataPoint${s2}`);
                for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = regularOpacity;
                }
              }
            }
          }, false);
          g2.appendChild(seriesLine);

          // draw the data points
          for (let a = 0; a < numPoints; a++) {
            let c = document.createElementNS(svgns, "circle");
            c.setAttribute('cx', `${(plot.dataX[s][a] - xMin) / xRange * plotWidth}`);
            c.setAttribute('cy', `${-(plot.dataY[s][a] - yMin) / yRange * plotHeight}`);
            c.setAttribute('r', radius);
            c.setAttribute('class', `dataPoint${s}`);
            c.addEventListener('mouseover', function() {
              var s2;
              for (s2 = 0; s2 < numSeries; s2++) {
                if (s2 != s) {
                  var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                  var i;
                  for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = deselectedOpacity;
                  }
                  x = document.getElementsByClassName(`dataPoint${s2}`);
                  for (i = 0; i < x.length; i++) {
                      x[i].style.opacity = deselectedOpacity;
                  }
                }
              }
              showValue.innerHTML = `x: ${(plot.dataX[s][a]).toFixed(xSigDigits+2)}, y: ${(plot.dataY[s][a]).toFixed(ySigDigits+2)}`;
            }, false);
            c.addEventListener('mouseout', function() {
              var s2;
              for (s2 = 0; s2 < numSeries; s2++) {
                if (s2 != s) {
                  var x = document.getElementsByClassName(`${seriesLabel}${s2}`);
                  var i;
                  for (i = 0; i < x.length; i++) {
                    x[i].style.opacity = regularOpacity;
                  }
                  x = document.getElementsByClassName(`dataPoint${s2}`);
                  for (i = 0; i < x.length; i++) {
                      x[i].style.opacity = regularOpacity;
                  }
                }
              }
              showValue.innerHTML = "";
            }, false);
            g2.appendChild(c);
          }
        }

        // Show value label
        showValue.setAttribute('id', 'showValue');
        showValue.setAttribute('y', -plotHeight + 20);
        g.appendChild(showValue);

        // plot border
        var plotBorder = document.createElementNS(svgns, "rect");
        plotBorder.setAttribute('x', 0);
        plotBorder.setAttribute('y', -plotHeight);
        plotBorder.setAttribute('width', plotWidth);
        plotBorder.setAttribute('height', plotHeight);
        plotBorder.id = "plotBorder";
        g.appendChild(plotBorder);

        // add a legend
        if (plot.seriesLabels.length > 0 && plot.drawLegend) {
          var legend = document.createElementNS(svgns, "g");
          legend.setAttribute('id', 'legend');
          g.appendChild(legend);
          for (let s = 0; s < numSeries; s++) {
            var y = -(plotHeight - 35 - 23 * (s+1));
            var line = document.createElementNS(svgns, "line");
            line.setAttribute('x1', plotWidth + 10);
            line.setAttribute('y1', y);
            line.setAttribute('x2', plotWidth + 40);
            line.setAttribute('y2', y);
            if (plot.drawPoints) {
              line.setAttribute('class', `seriesLine${s}`);
            } else {
              line.setAttribute('class', `seriesLineThick${s}`);
            }
            legend.appendChild(line);

            if (plot.drawPoints) {
              var c = document.createElementNS(svgns, "circle");
              c.setAttribute('cx', plotWidth+25);
              c.setAttribute('cy', y);
              c.setAttribute('r', radius);
              c.setAttribute('class', `dataPoint${s}`);
              legend.appendChild(c);
            }

            var legendLabel = document.createElementNS(svgns, "text");
            legendLabel.setAttribute('x', plotWidth + 48);
            legendLabel.setAttribute('y', y);
            legendLabel.setAttribute('text-anchor', 'left');
            // legendLabel.setAttribute('text-anchor', 'middle');
            legendLabel.setAttribute('dominant-baseline', 'middle');
            legendLabel.setAttribute('class', 'xTickLabel');
            legendLabel.innerHTML = plot.seriesLabels[s];
            legend.appendChild(legendLabel);
          }
        }

        // Add an invisible context menu to the parentId.
        var cm = document.createElement('div');
        cm.id = 'context-menu';
        cm.className = 'context-menu';
        var list = document.createElement('ul');

        var copyBtn = document.createElement("li");
        copyBtn.innerHTML = "Copy";
        copyBtn.addEventListener('click', function() {
          var content = `<svg xmlns='${svgns}' width='${plot.width}' height='${plot.height}'>\n${svg.innerHTML}\n</svg>`;
          // Create an auxiliary hidden input
          var aux = document.createElement("input");
          // Get the text from the element passed into the input
          aux.setAttribute("value", content);
          // Append the aux input to the body
          document.body.appendChild(aux);
          // Highlight the content
          aux.select();
          // Execute the copy command
          document.execCommand("copy");
          // Remove the input from the body
          document.body.removeChild(aux);
          // Give a notification
          alert("The plot's SVG content has been copied to the clipboard.");
        }, false);
        list.appendChild(copyBtn);

        var gridlineBtn = document.createElement("li");
        var verb = plot.drawGridlines ? "Hide " : "Show ";
        gridlineBtn.innerHTML = verb + "Gridlines";
        gridlineBtn.addEventListener('click', function() {
          plot.drawGridlines = !plot.drawGridlines;
          // update the context menu label
          var verb = plot.drawGridlines ? "Hide " : "Show ";
          gridlineBtn.innerHTML = verb + "Gridlines";
          update(svg);
        }, false);
        list.appendChild(gridlineBtn);

        if (plot.seriesLabels.length > 0) {
          var legendBtn = document.createElement("li");
          var verb = plot.drawLegend ? "Hide " : "Show ";
          legendBtn.innerHTML = verb + "Legend";
          legendBtn.addEventListener('click', function() {
            plot.drawLegend = !plot.drawLegend;
            // update the context menu label
            var verb = plot.drawLegend ? "Hide " : "Show ";
            legendBtn.innerHTML = verb + "Legend";
            update(svg);
          }, false);
          list.appendChild(legendBtn);
        }

        var pointsBtn = document.createElement("li");
        var verb = plot.drawPoints ? "Hide " : "Show ";
        pointsBtn.innerHTML = verb + "Points";
        pointsBtn.addEventListener('click', function() {
          plot.drawPoints = !plot.drawPoints;
          // update the context menu label
          var verb = plot.drawPoints ? "Hide " : "Show ";
          pointsBtn.innerHTML = verb + "Points";
          update(svg);
        }, false);
        list.appendChild(pointsBtn);

        var backgroundColorBtn = document.createElement("li");
        var verb = plot.drawGreyBackground ? "Light " : "Dark ";
        backgroundColorBtn.innerHTML = verb + "Background";
        backgroundColorBtn.addEventListener('click', function() {
          plot.drawGreyBackground = !plot.drawGreyBackground;
          // update the context menu label
          var verb = plot.drawGreyBackground ? "Light " : "Dark ";
          backgroundColorBtn.innerHTML = verb + "Background";
          update(svg);
        }, false);
        list.appendChild(backgroundColorBtn);

        cm.appendChild(list);
        document.getElementById(plot.parentId).appendChild(cm);

        var menu = document.getElementById('context-menu');
        document.onclick = function () {
            menu.style.display = 'none';
        };

        document.getElementById('plotSvg').oncontextmenu = function (evt) {
            evt = (evt) ? evt : ((event) ? event : null);
            var posnX = (evt.pageX) ? evt.pageX : ((evt.offsetX) ? evt.offsetX + 10 : null);
            var posnY = (evt.pageY) ? evt.pageY : ((evt.offsetY) ? evt.offsetY + 10 : null);
            menu.style.left = posnX + 'px';
            menu.style.top = posnY + 'px';
            menu.style.display = 'block';
            if (typeof evt.preventDefault != "undefined") {
                evt.preventDefault();
            } else {
                evt.returnValue = false;
            }
        };
      }

      function decimalPlaces(num) {
        var match = (''+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
        if (!match) { return 0; }
        return Math.max(
             0,
             // Number of digits right of decimal point.
             (match[1] ? match[1].length : 0)
             // Adjust for scientific notation.
             - (match[2] ? +match[2] : 0));
      }

      update(null);
    </script></div></body>